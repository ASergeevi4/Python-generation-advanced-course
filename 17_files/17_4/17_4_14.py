# https://stepik.org/lesson/519126/step/14?unit=511575

# Лог файл 📝🌶️
# Вам доступен текстовый файл logfile.txt с информацией о времени входа пользователя в систему и выхода из нее. Каждая строка файла содержит три значения, разделенные запятыми и символом пробела: имя пользователя, время входа, время выхода, где время указано в 24-часовом формате.

# Напишите программу, которая создает файл output.txt и выводит в него имена всех пользователей (не меняя порядка следования), которые были в сети не менее часа.

# Формат входных данных
# На вход программе ничего не подается.

# Формат выходных данных
# Программа должна создать файл с именем output.txt в соответствии с условием задачи.

# Примечание 1. Считайте, что исполняемая программа и указанные файлы находятся в одной папке.

# Примечание 2. Считайте, что каждый пользователь был только раз в системе, то есть в файле нет двух строк с одинаковым пользователем.


def convert_time(time:str) -> int:
    h, m = time.split(':')
    return int(h) * 60 + int(m)

with open('logfile.txt', 'rt', encoding='utf-8') as logfile, open('output.txt', 'wt', encoding='utf-8') as output:
    users = [el.strip().split(', ') for el in logfile]
    for el in users:
        if convert_time(el[2]) - convert_time(el[1]) >= 60:
            print(el[0], file=output)
